"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[2302],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),m=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=m(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=m(n),c=r,h=u["".concat(s,".").concat(c)]||u[c]||d[c]||i;return n?a.createElement(h,o(o({ref:t},p),{},{components:n})):a.createElement(h,o({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:r,o[1]=l;for(var m=2;m<i;m++)o[m]=n[m];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},23578:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>m});var a=n(87462),r=(n(67294),n(3905));const i={title:"Build your own AI Meme Generator & learn how to use OpenAI's function calls",authors:["vinny"],image:"/img/memerator-banner-tall.gif",tags:["ai","meme","openai","function calling","react","full-stack","generate"]},o=void 0,l={permalink:"/blog/2023/09/17/ai-meme-generator-how-to-use-openai-function-call",editUrl:"https://github.com/wasp-lang/wasp/edit/release/web/blog/2023-09-17-ai-meme-generator-how-to-use-openai-function-call.md",source:"@site/blog/2023-09-17-ai-meme-generator-how-to-use-openai-function-call.md",title:"Build your own AI Meme Generator & learn how to use OpenAI's function calls",description:"Table of Contents",date:"2023-09-17T00:00:00.000Z",formattedDate:"September 17, 2023",tags:[{label:"ai",permalink:"/blog/tags/ai"},{label:"meme",permalink:"/blog/tags/meme"},{label:"openai",permalink:"/blog/tags/openai"},{label:"function calling",permalink:"/blog/tags/function-calling"},{label:"react",permalink:"/blog/tags/react"},{label:"full-stack",permalink:"/blog/tags/full-stack"},{label:"generate",permalink:"/blog/tags/generate"}],readingTime:30.015,hasTruncateMarker:!1,authors:[{name:"Vinny",title:"DevRel @ Wasp",url:"https://vincanger.github.io",email:"vince@wasp-lang.dev",imageURL:"https://vincanger.github.io/assets/vince_smiley.jpg",key:"vinny"}],frontMatter:{title:"Build your own AI Meme Generator & learn how to use OpenAI's function calls",authors:["vinny"],image:"/img/memerator-banner-tall.gif",tags:["ai","meme","openai","function calling","react","full-stack","generate"]},prevItem:{title:"Contributing to Tech Communities: How Open-Source can land you a job and get you out of the Skill Paradox",permalink:"/blog/2023/10/04/contributing-open-source-land-a-job"},nextItem:{title:"Using Product Requirement Documents to Generate Better Web Apps with AI",permalink:"/blog/2023/08/23/using-product-requirement-documents-generate-better-web-apps-with-ai"}},s={authorsImageUrls:[void 0]},m=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Call Me, Maybe",id:"call-me-maybe",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Set up your Wasp project",id:"set-up-your-wasp-project",level:3},{value:"Setting up the Database",id:"setting-up-the-database",level:3},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Start your App",id:"start-your-app",level:3},{value:"Generating a Meme",id:"generating-a-meme",level:2},{value:"Server-Side Code",id:"server-side-code",level:3},{value:"Client-Side Code",id:"client-side-code",level:3},{value:"Fetching &amp; Updating Templates with Cron Jobs",id:"fetching--updating-templates-with-cron-jobs",level:2},{value:"Defining our Daily Cron Job",id:"defining-our-daily-cron-job",level:3},{value:"Testing",id:"testing",level:3},{value:"Editing Memes",id:"editing-memes",level:2},{value:"Server-Side Code",id:"server-side-code-1",level:3},{value:"Client-Side Code",id:"client-side-code-1",level:3},{value:"Deleting Memes",id:"deleting-memes",level:2}],p={toc:m},u="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"table-of-contents"},"Table of Contents"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#tldr"},"TL;DR")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#intro"},"Intro"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#intro"},"Call Me, Maybe")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#lets-build"},"Let's Build")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#config"},"Part 1"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#config"},"Configuration"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#setup"},"Project Set Up")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#db"},"Database Set up")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#env"},"Environment Variables")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#start"},"Start Your App")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#generate-meme"},"Generating Memes"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#generate-server"},"Server-Side Code")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#generate-client"},"Client-Side Code")))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#part-two"},"Part 2"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#templates"},"Fetching & Updating Templates w/ Cron Jobs"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#cron"},"Defining our Daily Cron Job")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#cron-test"},"Testing")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#edit"},"Editing Memes"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#server"},"Server-Side Code")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#client"},"Client-Side Code")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#delete"},"Deleting Memes")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#conclusion"},"Conclusion"))),(0,r.kt)("a",{name:"tldr",href:"#tldr"}),"# TL;DR",(0,r.kt)("p",null,"In this two-part tutorial, we\u2019re going to build a full-stack instant Meme Generator app using:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"React & NodeJS w/ TypeScript"),(0,r.kt)("li",{parentName:"ul"},"OpenAI\u2019s ",(0,r.kt)("a",{parentName:"li",href:"https://platform.openai.com/docs/guides/gpt/function-calling"},"Function Calling API")),(0,r.kt)("li",{parentName:"ul"},"ImgFlip.com\u2019s ",(0,r.kt)("a",{parentName:"li",href:"https://imgflip.com/api"},"meme creator API"))),(0,r.kt)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/4rTXljsphQ8?si=Lny4ruPRNJu3-zwL",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:!0}),(0,r.kt)("p",null,"You check out a deployed version of the app we\u2019re going to build here: ",(0,r.kt)("a",{parentName:"p",href:"https://damemerator.netlify.app"},"The Memerator")),(0,r.kt)("p",null,"If you just want to see the code for the finished app, check out the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/vincanger/memerator"},"Memerator\u2019s GitHub Repo")),(0,r.kt)("a",{name:"intro",href:"#intro"}),"# Intro",(0,r.kt)("h2",{id:"call-me-maybe"},"Call Me, Maybe"),(0,r.kt)("p",null,"With ",(0,r.kt)("a",{parentName:"p",href:"https://platform.openai.com/docs/guides/gpt"},"OpenAI\u2019s chat completions API"),", developers are now able to do some really cool stuff. It basically enables ChatGPT functionality, but in the form of a callable API you can integrate into any app."),(0,r.kt)("p",null,"But when working with the API, a lot of devs wanted GPT to give back data in a format, like JSON, that they could use in their app\u2019s functions."),(0,r.kt)("p",null,"Unfortunately, if you asked ChatGPT to return the data in a certain format, it wouldn\u2019t always get it right. Which is why ",(0,r.kt)("a",{parentName:"p",href:"https://platform.openai.com/docs/guides/gpt/function-calling"},"OpenAI released function calling"),"."),(0,r.kt)("p",null,"As they describe it, function calling allows devs to \u201c\u2026 describe functions to\xa0GPT, and have the model intelligently choose to output a JSON object containing arguments to call those functions.\u201d"),(0,r.kt)("p",null,"This is a great way to turn natural language into an API call."),(0,r.kt)("p",null,"So what better way to learn how to use GPT\u2019s function calling feature than to use it to call ",(0,r.kt)("a",{parentName:"p",href:"https://imgflip.com/api"},"Imgflip.com\u2019s meme creator API"),"!?"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0a0bc9uxabyg8cue2axu.png",alt:"Image description"})),(0,r.kt)("a",{name:"lets-build",href:"#lets-build"}),"## Let\u2019s Build",(0,r.kt)("p",null,"In this two-part tutorial, we\u2019re going to build a full-stack React/NodeJS app with:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Authentication"),(0,r.kt)("li",{parentName:"ul"},"Meme generation via OpenAI\u2019s function calling and ImgFlip.com\u2019s API"),(0,r.kt)("li",{parentName:"ul"},"Daily cron job to fetch new meme templates"),(0,r.kt)("li",{parentName:"ul"},"Meme editing and deleting"),(0,r.kt)("li",{parentName:"ul"},"and more!")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/dwkbfq9kx8xlu7fb25v0.png",alt:"Image description"})),(0,r.kt)("p",null,"I already deployed a working version of this app that you can try out here: ",(0,r.kt)("a",{parentName:"p",href:"https://damemerator.netlify.app"},"https://damemerator.netlify.app")," \u2014 so give it a go and let\u2019s get\u2026 going."),(0,r.kt)("p",null,"In Part 1 of this tutorial, we will get the app set up and generating and displaying memes. "),(0,r.kt)("p",null,"In Part 2, we will add more functionality, like recurring cron jobs to fetch more meme templates, and the ability to edit and delete memes."),(0,r.kt)("p",null,"BTW, two quick tips:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"if you need to reference the app\u2019s finished code at any time to help you with this tutorial, you can check out the app\u2019s ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/vincanger/memerator"},"GitHub Repo here"),". "),(0,r.kt)("li",{parentName:"ol"},"if you have any questions, feel free to hop into the ",(0,r.kt)("a",{parentName:"li",href:"https://discord.gg/rzdnErX"},"Wasp Discord Server")," and ask us!")),(0,r.kt)("h1",{id:"part-1"},"Part 1"),(0,r.kt)("a",{name:"config",href:"#config"}),(0,r.kt)("h2",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"We\u2019re going to make this a full-stack React/NodeJS web app so we need to get that set up first. But don\u2019t worry, it won\u2019t take long AT ALL, because we will be using ",(0,r.kt)("a",{parentName:"p",href:"https://wasp-lang.dev"},"Wasp")," as the framework."),(0,r.kt)("p",null,"Wasp does all the heavy lifting for us. You\u2019ll see what I mean in a second."),(0,r.kt)("a",{name:"setup",href:"#setup"}),(0,r.kt)("h3",{id:"set-up-your-wasp-project"},"Set up your Wasp project"),(0,r.kt)("p",null,"First, install Wasp by running this in your terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -sSL <https://get.wasp-lang.dev/installer.sh> | sh\n")),(0,r.kt)("p",null,"Next, let\u2019s clone the ",(0,r.kt)("inlineCode",{parentName:"p"},"start")," branch of the ",(0,r.kt)("a",{parentName:"p",href:"http://damemerator.netlify.app"},"Memerator")," app that I\u2019ve prepared for you:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"git clone -b start https://github.com/vincanger/memerator.git\n")),(0,r.kt)("p",null,"Then navigate into the ",(0,r.kt)("inlineCode",{parentName:"p"},"Memerator")," directory and open up the project in VS Code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd Memerator && code .\n")),(0,r.kt)("p",null,"You\u2019ll notice Wasp sets up your full-stack app with a file structure like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},".\n\u251c\u2500\u2500 main.wasp             # The wasp config file.\n\u2514\u2500\u2500 src\n \xa0\xa0 \u251c\u2500\u2500 client            # Your React client code (JS/CSS/HTML) goes here.\n \xa0\xa0 \u251c\u2500\u2500 server            # Your server code (Node JS) goes here.\n \xa0\xa0 \u2514\u2500\u2500 shared            # Your shared (runtime independent) code goes here.\n\n")),(0,r.kt)("p",null,"Let\u2019s check out the ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," file first. You can think of it as the \u201cskeleton\u201d, or instructions, of your app. This file configures most of your full-stack app for you \ud83e\udd2f:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'app Memerator {\n  wasp: {\n    version: "^0.11.3"\n  },\n  title: "Memerator",\n  client: {\n    rootComponent: import { Layout } from "@client/Layout",\n  },\n  db: {\n    system: PostgreSQL,\n    prisma: {\n      clientPreviewFeatures: ["extendedWhereUnique"]\n    }\n  },\n  auth: {\n    userEntity: User,\n    methods: {\n      usernameAndPassword: {}\n    },\n    onAuthFailedRedirectTo: "/login",\n    onAuthSucceededRedirectTo: "/"\n  },\n  dependencies: [\n    ("openai", "4.2.0"),\n    ("axios", "^1.4.0"),\n    ("react-icons", "4.10.1"),\n  ]\n}\n\nentity User {=psl\n    id       Int    @id @default(autoincrement())\n    username String @unique\n    password String\n    memes    Meme[]\n    isAdmin  Boolean @default(false)\n    credits  Int     @default(2)\npsl=}\n\nentity Meme {=psl\n    id         String @id @default(uuid())\n    url        String \n    text0      String\n    text1      String\n    topics     String \n    audience   String \n    template   Template @relation(fields: [templateId], references: [id])\n    templateId String\n    user       User   @relation(fields: [userId], references: [id])\n    userId     Int    \n    createdAt  DateTime @default(now())\npsl=}\n\nentity Template {=psl\n    id       String @id @unique\n    name     String\n    url      String\n    width    Int\n    height   Int\n    boxCount Int\n    memes    Meme[]\npsl=}\n\nroute HomePageRoute { path: "/", to: HomePage }\npage HomePage {\n  component: import { HomePage } from "@client/pages/Home",\n}\n\nroute LoginRoute { path: "/login", to: LoginPage }\npage LoginPage {\n  component: import Login from "@client/pages/auth/Login"\n}\nroute SignupRoute { path: "/signup", to: SignupPage }\npage SignupPage {\n  component: import Signup from "@client/pages/auth/Signup"\n}\n')),(0,r.kt)("p",null,"As you can see, our ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," config file has our:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"dependencies,"),(0,r.kt)("li",{parentName:"ul"},"authentication method,"),(0,r.kt)("li",{parentName:"ul"},"database type, and"),(0,r.kt)("li",{parentName:"ul"},"database models (\u201dentities\u201d)"),(0,r.kt)("li",{parentName:"ul"},"client-side pages & routes")),(0,r.kt)("p",null,"You might have also noticed this ",(0,r.kt)("inlineCode",{parentName:"p"},"{=psl psl=}")," syntax in the entities above. This denotes that anything in between these ",(0,r.kt)("inlineCode",{parentName:"p"},"psl")," brackets is actually a different language, in this case, ",(0,r.kt)("a",{parentName:"p",href:"https://www.prisma.io/docs/concepts/components/prisma-schema"},"Prisma Schema Language"),". Wasp uses Prisma under the hood, so if you've used Prisma before, it should be straightforward."),(0,r.kt)("p",null,"Also, make sure you install the ",(0,r.kt)("a",{parentName:"p",href:"https://marketplace.visualstudio.com/items?itemName=wasp-lang.wasp"},"Wasp VS code extension")," so that you get nice syntax highlighting and the best overall dev experience."),(0,r.kt)("a",{name:"db",href:"#db"}),(0,r.kt)("h3",{id:"setting-up-the-database"},"Setting up the Database"),(0,r.kt)("p",null,"We still need to get a Postgres database setup. "),(0,r.kt)("p",null,"Usually this can be pretty annoying, but with Wasp it\u2019s really easy."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"just have ",(0,r.kt)("a",{parentName:"li",href:"https://www.docker.com/products/docker-desktop/"},"Docker Deskop")," installed and running, "),(0,r.kt)("li",{parentName:"ol"},"open up ",(0,r.kt)("strong",{parentName:"li"},"a separate terminal tab/window,")," "),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"cd")," into the ",(0,r.kt)("inlineCode",{parentName:"li"},"Memerator")," directory, and then run")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"wasp start db\n")),(0,r.kt)("p",null,"This will start and connect your app to a Postgres database for you. No need to do anything else! \ud83e\udd2f\xa0"),(0,r.kt)("p",null,"Just leave this terminal tab, along with docker desktop, open and running in the background."),(0,r.kt)("p",null,"Now, in a different terminal tab, run"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"wasp db migrate-dev\n")),(0,r.kt)("p",null,"and make sure to give your database migration a name, like ",(0,r.kt)("inlineCode",{parentName:"p"},"init"),"."),(0,r.kt)("a",{name:"env",href:"#env"}),(0,r.kt)("h3",{id:"environment-variables"},"Environment Variables"),(0,r.kt)("p",null,"In the root of your project, you\u2019ll find a ",(0,r.kt)("inlineCode",{parentName:"p"},".env.server.example")," file that looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# set up your own credentials on https://imgflip.com/signup and rename this file to .env.server\n# NOTE: make sure you register with Username and Password (not google) \nIMGFLIP_USERNAME=\nIMGFLIP_PASSWORD=\n\n# get your api key from https://platform.openai.com/\nOPENAI_API_KEY=\n\nJWT_SECRET=asecretphraseatleastthirtytwocharacterslong\n")),(0,r.kt)("p",null,"Rename this file to ",(0,r.kt)("inlineCode",{parentName:"p"},".env.server")," and follow the instructions in it to get your:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://imgflip.com/signup"},"Imgflip credentials")," and"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://platform.openai.com/"},"OpenAI API keys"))),(0,r.kt)("p",null,"as we will need them to generate our memes \ud83e\udd21"),(0,r.kt)("a",{name:"start",href:"#start"}),(0,r.kt)("h3",{id:"start-your-app"},"Start your App"),(0,r.kt)("p",null,"With everything setup correctly, you should now be able to run "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"wasp start\n")),(0,r.kt)("p",null,"When running ",(0,r.kt)("inlineCode",{parentName:"p"},"wasp start"),", Wasp will install all the necessary npm packages, start our NodeJS server on port 3001, and our React client on port 3000. "),(0,r.kt)("p",null,"Head to ",(0,r.kt)("a",{parentName:"p",href:"http://localhost:3000/"},"localhost:3000")," in your browser to check it out. We should have the basis for our app that looks like this:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/l1541hswduhm7d2bm8oz.png",alt:"Image description"})),(0,r.kt)("a",{name:"generate-meme",href:"#generate-meme"}),(0,r.kt)("h2",{id:"generating-a-meme"},"Generating a Meme"),(0,r.kt)("p",null,"The boilerplate code already has the client-side form set up for generating memes based on:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"topics"),(0,r.kt)("li",{parentName:"ul"},"intended audience")),(0,r.kt)("p",null,"This is the info we will send to the backend to call the OpenAI API using function calls. We then send this info to the ",(0,r.kt)("a",{parentName:"p",href:"https://imgflip.com/api"},"imglfip.com API")," to generate the meme."),(0,r.kt)("p",null,"But the ",(0,r.kt)("strong",{parentName:"p"},"/caption_image")," endpoint of the imgflip API needs the meme template id. And to get that ID we first need to fetch the available meme templates from imgflip\u2019s ",(0,r.kt)("strong",{parentName:"p"},"/get_memes")," endpoint"),(0,r.kt)("p",null,"So let\u2019s set that up now."),(0,r.kt)("a",{name:"generate-server",href:"#generate-server"}),(0,r.kt)("h3",{id:"server-side-code"},"Server-Side Code"),(0,r.kt)("p",null,"Create a new file in ",(0,r.kt)("inlineCode",{parentName:"p"},"src/server/")," called ",(0,r.kt)("inlineCode",{parentName:"p"},"utils.ts"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import axios from 'axios';\nimport { stringify } from 'querystring';\nimport HttpError from '@wasp/core/HttpError.js';\n\ntype GenerateMemeArgs = {\n  text0: string;\n  text1: string;\n  templateId: string;\n};\n\nexport const fetchMemeTemplates = async () => {\n  try {\n    const response = await axios.get('https://api.imgflip.com/get_memes');\n    return response.data.data.memes;\n  } catch (error) {\n    console.error(error);\n    throw new HttpError(500, 'Error fetching meme templates');\n  }\n};\n\nexport const generateMemeImage = async (args: GenerateMemeArgs) => {\n  console.log('args: ', args);\n\n  try {\n    const data = stringify({\n      template_id: args.templateId,\n      username: process.env.IMGFLIP_USERNAME,\n      password: process.env.IMGFLIP_PASSWORD,\n      text0: args.text0,\n      text1: args.text1,\n    });\n\n    // Implement the generation of meme using the Imgflip API\n    const res = await axios.post('https://api.imgflip.com/caption_image', data, {\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n    });\n\n    const url = res.data.data.url;\n\n    console.log('generated meme url: ', url);\n\n    return url as string;\n  } catch (error) {\n    console.error(error);\n    throw new HttpError(500, 'Error generating meme image');\n  }\n};\n")),(0,r.kt)("p",null,"This gives us some utility functions to help us fetch all the meme templates that we can possibly generate meme images with."),(0,r.kt)("p",null,"Notice that the POST request to the ",(0,r.kt)("strong",{parentName:"p"},"/caption_image")," endpoint takes the following data:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"our imgflip ",(0,r.kt)("strong",{parentName:"li"},"username")," and ",(0,r.kt)("strong",{parentName:"li"},"password")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"ID")," of the meme template we will use"),(0,r.kt)("li",{parentName:"ul"},"the text for top of the meme, i.e. ",(0,r.kt)("strong",{parentName:"li"},"text0")),(0,r.kt)("li",{parentName:"ul"},"the text for the bottom of the meme, i.e. ",(0,r.kt)("strong",{parentName:"li"},"text1"))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gt16im7qb0agg6m2idft.png",alt:"Image description"})),(0,r.kt)("p",null,"The text0 and text1 arguments will generated for us by our lovely friend, ChatGPT. But in order for GPT to do that, we have to set up its API call, too."),(0,r.kt)("p",null,"To do that, create a new file in ",(0,r.kt)("inlineCode",{parentName:"p"},"src/server/")," called ",(0,r.kt)("inlineCode",{parentName:"p"},"actions.ts"),". "),(0,r.kt)("p",null,"Then go back to your ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," config file and add the following Wasp Action at the bottom of the file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},'//...\n\naction createMeme {\n  fn: import { createMeme } from "@server/actions.js",\n  entities: [Meme, Template, User]\n}\n')),(0,r.kt)("p",null,"An ",(0,r.kt)("a",{parentName:"p",href:"https://wasp-lang.dev/docs/data-model/operations/actions"},"Action is a type of Wasp Operation")," that changes some state on the backend. It\u2019s essentially a NodeJS function that gets called on the server, but Wasp takes care of setting it all up for you."),(0,r.kt)("p",null,"This means you don't have to worry about building an HTTP API for the Action, managing server-side request handling, or even dealing with client-side response handling and caching. Instead, you just write the business logic!"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/i1qoo0k5hg2hl3i49lqb.png",alt:"Image description"})),(0,r.kt)("p",null,"If you\u2019ve got the ",(0,r.kt)("a",{parentName:"p",href:"https://marketplace.visualstudio.com/items?itemName=wasp-lang.wasp"},"Wasp VS Code extension installed"),", you\u2019ll see an error (above). Hover over it and click ",(0,r.kt)("inlineCode",{parentName:"p"},"Quick Fix")," > ",(0,r.kt)("inlineCode",{parentName:"p"},"create function createMeme"),"."),(0,r.kt)("p",null,"This will scaffold a ",(0,r.kt)("inlineCode",{parentName:"p"},"createMeme")," function (below) for you in your ",(0,r.kt)("inlineCode",{parentName:"p"},"actions.ts")," file if the file exists. Pretty Cool!"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import { CreateMeme } from '@wasp/actions/types'\n\ntype CreateMemeInput = void\ntype CreateMemeOutput = void\n\nexport const createMeme: CreateMeme<CreateMemeInput, CreateMemeOutput> = async (args, context) => {\n  // Implementation goes here\n}\n")),(0,r.kt)("p",null,"You can see that it imports the Action types for you as well."),(0,r.kt)("p",null,"Because we will be sending the ",(0,r.kt)("inlineCode",{parentName:"p"},"topics")," array and the intended ",(0,r.kt)("inlineCode",{parentName:"p"},"audience")," string for the meme from our front-end form, and in the end we will return the newly created ",(0,r.kt)("inlineCode",{parentName:"p"},"Meme")," entity, that\u2019s what we should define our types as. "),(0,r.kt)("p",null,"Remember, the ",(0,r.kt)("inlineCode",{parentName:"p"},"Meme")," entity is the database model we defined in our ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," config file."),(0,r.kt)("p",null,"Knowing that, we can change the content of ",(0,r.kt)("inlineCode",{parentName:"p"},"actions.ts")," to this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import type { CreateMeme } from '@wasp/actions/types'\nimport type { Meme } from '@wasp/entities';\n\ntype CreateMemeArgs = { topics: string[]; audience: string };\n\nexport const createMeme: CreateMeme<CreateMemeArgs, Meme> = async ({ topics, audience }, context) => {\n  // Implementation goes here\n}\n")),(0,r.kt)("p",null,"Before we implement the rest of the logic, let\u2019s run through how our ",(0,r.kt)("inlineCode",{parentName:"p"},"createMeme")," function should work and how our ",(0,r.kt)("inlineCode",{parentName:"p"},"Meme")," will get generated:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"fetch the imgflip meme template we want to use"),(0,r.kt)("li",{parentName:"ol"},"send its name, the topics, and intended audience to OpenAI\u2019s chat completions API"),(0,r.kt)("li",{parentName:"ol"},"tell OpenAI we want the result back as arguments we can pass to our next function in JSON format, i.e. OpenAI\u2019s ",(0,r.kt)("a",{parentName:"li",href:"https://platform.openai.com/docs/guides/gpt/function-calling"},"function calling")),(0,r.kt)("li",{parentName:"ol"},"pass those arguments to the imgflip ",(0,r.kt)("strong",{parentName:"li"},"/caption-image")," endpoint and get our created meme\u2019s url"),(0,r.kt)("li",{parentName:"ol"},"save the meme url and other info into our DB as a ",(0,r.kt)("inlineCode",{parentName:"li"},"Meme")," entity")),(0,r.kt)("p",null,"With all that in mind, go ahead and entirely replace the content in our ",(0,r.kt)("inlineCode",{parentName:"p"},"actions.ts")," with the completed ",(0,r.kt)("inlineCode",{parentName:"p"},"createMeme")," action:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import HttpError from '@wasp/core/HttpError.js';\nimport OpenAI from 'openai';\nimport { fetchMemeTemplates, generateMemeImage } from './utils.js';\n\nimport type { CreateMeme } from '@wasp/actions/types';\nimport type { Meme, Template } from '@wasp/entities';\n\ntype CreateMemeArgs = { topics: string[]; audience: string };\n\nconst openai = new OpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport const createMeme: CreateMeme<CreateMemeArgs, Meme> = async ({ topics, audience }, context) => {\n  if (!context.user) {\n    throw new HttpError(401, 'You must be logged in');\n  }\n\n  if (context.user.credits === 0 && !context.user.isAdmin) {\n    throw new HttpError(403, 'You have no credits left');\n  }\n\n  const topicsStr = topics.join(', ');\n\n  let templates: Template[] = await context.entities.Template.findMany({});\n\n    if (templates.length === 0) {\n    const memeTemplates = await fetchMemeTemplates();\n    templates = await Promise.all(\n      memeTemplates.map(async (template: any) => {\n        const addedTemplate = await context.entities.Template.upsert({\n          where: { id: template.id },\n          create: {\n            id: template.id,\n            name: template.name,\n            url: template.url,\n            width: template.width,\n            height: template.height,\n            boxCount: template.box_count\n          },\n          update: {}\n        });\n\n        return addedTemplate;\n      })\n    );\n  }\n\n  // filter out templates with box_count > 2\n  templates = templates.filter((template) => template.boxCount <= 2);\n  const randomTemplate = templates[Math.floor(Math.random() * templates.length)];\n\n  console.log('random template: ', randomTemplate);\n\n  const sysPrompt = `You are a meme idea generator. You will use the imgflip api to generate a meme based on an idea you suggest. Given a random template name and topics, generate a meme idea for the intended audience. Only use the template provided`;\n  const userPrompt = `Topics: ${topicsStr} \\n Intended Audience: ${audience} \\n Template: ${randomTemplate.name} \\n`;\n\n  let openAIResponse: OpenAI.Chat.Completions.ChatCompletion;\n  try {\n    openAIResponse = await openai.chat.completions.create({\n      messages: [\n        { role: 'system', content: sysPrompt },\n        { role: 'user', content: userPrompt },\n      ],\n      functions: [\n        {\n          name: 'generateMemeImage',\n          description: 'Generate meme via the imgflip API based on the given idea',\n          parameters: {\n            type: 'object',\n            properties: {\n              text0: { type: 'string', description: 'The text for the top caption of the meme' },\n              text1: { type: 'string', description: 'The text for the bottom caption of the meme' },\n            },\n            required: ['templateName', 'text0', 'text1'],\n          },\n        },\n      ],\n      function_call: {\n        name: 'generateMemeImage',\n      },\n      model: 'gpt-4-0613',\n    });\n  } catch (error: any) {\n    console.error('Error calling openAI: ', error);\n    throw new HttpError(500, 'Error calling openAI');\n  }\n\n  console.log(openAIResponse.choices[0]);\n\n  /**\n   * the Function call returned by openAI looks like this:\n   */\n  // {\n  //   index: 0,\n  //   message: {\n  //     role: 'assistant',\n  //     content: null,\n  //     function_call: {\n  //       name: 'generateMeme',\n  //       arguments: '{\\n' +\n  //         `  \"text0\": \"CSS you've been writing all day\",\\n` +\n  //         '  \"text1\": \"This looks horrible\"\\n' +\n  //         '}'\n  //     }\n  //   },\n  //   finish_reason: 'stop'\n  // }\n  if (!openAIResponse.choices[0].message.function_call) throw new HttpError(500, 'No function call in openAI response');\n\n  const gptArgs = JSON.parse(openAIResponse.choices[0].message.function_call.arguments);\n  console.log('gptArgs: ', gptArgs);\n\n  const memeIdeaText0 = gptArgs.text0;\n  const memeIdeaText1 = gptArgs.text1;\n\n  console.log('meme Idea args: ', memeIdeaText0, memeIdeaText1);\n\n  const memeUrl = await generateMemeImage({\n    templateId: randomTemplate.id,\n    text0: memeIdeaText0,\n    text1: memeIdeaText1,\n  });\n\n  const newMeme = await context.entities.Meme.create({\n    data: {\n      text0: memeIdeaText0,\n      text1: memeIdeaText1,\n      topics: topicsStr,\n      audience: audience,\n      url: memeUrl,\n      template: { connect: { id: randomTemplate.id } },\n      user: { connect: { id: context.user.id } },\n    },\n  });\n\n  return newMeme;\n};\n")),(0,r.kt)("p",null,"At this point, the code above should be pretty self-explanatory, but I want to highlight a couple points:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"the ",(0,r.kt)("inlineCode",{parentName:"li"},"context")," object is passed through to all Actions and Queries by Wasp. It contains the ",(0,r.kt)("a",{parentName:"li",href:"https://prisma.io"},"Prisma")," client with access to the DB entities you defined in your  ",(0,r.kt)("inlineCode",{parentName:"li"},"main.wasp")," config file."),(0,r.kt)("li",{parentName:"ol"},"We first look for the imgflip meme templates in our DB. If none are found, we fetch them using our ",(0,r.kt)("inlineCode",{parentName:"li"},"fetchTemplates")," utility function we defined earlier. Then we ",(0,r.kt)("inlineCode",{parentName:"li"},"upsert")," them into our DB."),(0,r.kt)("li",{parentName:"ol"},"There are some meme templates that take more than 2 text boxes, but for this tutorial we\u2019re only using meme templates with 2 text inputs to make it easier."),(0,r.kt)("li",{parentName:"ol"},"We choose a random template from this list to use as a basis for our meme (it\u2019s actually a great way to serendipitously generate some interesting meme content)."),(0,r.kt)("li",{parentName:"ol"},"We give the OpenAI API info about the functions it can create arguments for via the ",(0,r.kt)("inlineCode",{parentName:"li"},"functions")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"function_call")," properties, which tell it to always return JSON arguments for our function, ",(0,r.kt)("inlineCode",{parentName:"li"},"generateMemeImage"))),(0,r.kt)("p",null,"Great! But once we start generating memes, we will need a way to display them on our front end."),(0,r.kt)("p",null,"So let\u2019s now create a Wasp Query. A Query works just like an Action, except it\u2019s only for ",(0,r.kt)("em",{parentName:"p"},"reading")," data."),(0,r.kt)("p",null,"Go to ",(0,r.kt)("inlineCode",{parentName:"p"},"src/server")," and create a new file called ",(0,r.kt)("inlineCode",{parentName:"p"},"queries.ts"),"."),(0,r.kt)("p",null,"Next, in your ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," file add the following code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},'//...\n\nquery getAllMemes {\n  fn: import { getAllMemes } from "@server/queries.js",\n  entities: [Meme]\n}\n')),(0,r.kt)("p",null,"Then in your ",(0,r.kt)("inlineCode",{parentName:"p"},"queries.ts")," file, add the ",(0,r.kt)("inlineCode",{parentName:"p"},"getAllMemes")," function:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import HttpError from '@wasp/core/HttpError.js';\n\nimport type { Meme } from '@wasp/entities';\nimport type { GetAllMemes } from '@wasp/queries/types';\n\nexport const getAllMemes: GetAllMemes<void, Meme[]> = async (_args, context) => {\n  const memeIdeas = await context.entities.Meme.findMany({\n    orderBy: { createdAt: 'desc' },\n    include: { template: true },\n  });\n\n  return memeIdeas;\n};\n")),(0,r.kt)("a",{name:"generate-client",href:"#generate-client"}),(0,r.kt)("h3",{id:"client-side-code"},"Client-Side Code"),(0,r.kt)("p",null,"Now that we\u2019ve got the ",(0,r.kt)("inlineCode",{parentName:"p"},"createMeme")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"getAllMemes")," code implemented server-side, let\u2019s hook it up to our client. "),(0,r.kt)("p",null,"Wasp makes it really easy to import the Operations we just created and call them on our front end."),(0,r.kt)("p",null,"You can do so by going to ",(0,r.kt)("inlineCode",{parentName:"p"},"src/client/pages/Home.tsx")," and adding the following code to the top of the file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"//...other imports...\nimport { useQuery } from '@wasp/queries';\nimport createMeme from '@wasp/actions/createMeme';\nimport getAllMemes from '@wasp/queries/getAllMemes';\nimport useAuth from '@wasp/auth/useAuth';\n\nexport function HomePage() {\n  const [topics, setTopics] = useState(['']);\n  const [audience, setAudience] = useState('');\n  const [isMemeGenerating, setIsMemeGenerating] = useState(false);\n\n  // \ud83d\ude0e \ud83d\ude0e \ud83d\ude0e\n  const { data: user } = useAuth();\n  const { data: memes, isLoading, error } = useQuery(getAllMemes); \n\n  const handleGenerateMeme: FormEventHandler<HTMLFormElement> = async (e) => {\n    e.preventDefault();\n    if (!user) {\n      history.push('/login');\n      return;\n    }\n    if (topics.join('').trim().length === 0 || audience.length === 0) {\n      alert('Please provide topic and audience');\n      return;\n    }\n    try {\n      setIsMemeGenerating(true);\n      await createMeme({ topics, audience }); // <--- \ud83d\ude0e \ud83d\ude0e \ud83d\ude0e\n    } catch (error: any) {\n      alert('Error generating meme: ' + error.message);\n    } finally {\n      setIsMemeGenerating(false);\n    }\n  };\n\n//...\n")),(0,r.kt)("p",null,"As you can see, we\u2019ve imported ",(0,r.kt)("inlineCode",{parentName:"p"},"createMeme")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"getAllMemes")," (\ud83d\ude0e). "),(0,r.kt)("p",null,"For ",(0,r.kt)("inlineCode",{parentName:"p"},"getAllMemes"),", we wrap it in the ",(0,r.kt)("inlineCode",{parentName:"p"},"useQuery")," hook so that we can fetch and cache the data. On the other hand, our ",(0,r.kt)("inlineCode",{parentName:"p"},"createMeme")," Action gets called in ",(0,r.kt)("inlineCode",{parentName:"p"},"handleGenerateMeme")," which we will call when submit our form."),(0,r.kt)("p",null,"Rather than adding code to the ",(0,r.kt)("inlineCode",{parentName:"p"},"Home.tsx")," file piece-by-piece, here is the file with all the code to generate and display the memes. Go ahead and replace all of ",(0,r.kt)("inlineCode",{parentName:"p"},"Home.tsx")," with this code and I\u2019ll explain it in more detail below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import { useState, FormEventHandler } from 'react';\nimport { useQuery } from '@wasp/queries';\nimport createMeme from '@wasp/actions/createMeme';\nimport getAllMemes from '@wasp/queries/getAllMemes';\nimport useAuth from '@wasp/auth/useAuth';\nimport { useHistory } from 'react-router-dom';\nimport {\n  AiOutlinePlusCircle,\n  AiOutlineMinusCircle,\n  AiOutlineRobot,\n} from 'react-icons/ai';\n\nexport function HomePage() {\n  const [topics, setTopics] = useState(['']);\n  const [audience, setAudience] = useState('');\n  const [isMemeGenerating, setIsMemeGenerating] = useState(false);\n\n  const history = useHistory();\n  const { data: user } = useAuth();\n  const { data: memes, isLoading, error } = useQuery(getAllMemes);\n\n  const handleGenerateMeme: FormEventHandler<HTMLFormElement> = async (e) => {\n    e.preventDefault();\n    if (!user) {\n      history.push('/login');\n      return;\n    }\n    if (topics.join('').trim().length === 0 || audience.length === 0) {\n      alert('Please provide topic and audience');\n      return;\n    }\n    try {\n      setIsMemeGenerating(true);\n      await createMeme({ topics, audience });\n    } catch (error: any) {\n      alert('Error generating meme: ' + error.message);\n    } finally {\n      setIsMemeGenerating(false);\n    }\n  };\n\n  const handleDeleteMeme = async (id: string) => {\n    //...\n  };\n\n  if (isLoading) return 'Loading...';\n  if (error) return 'Error: ' + error;\n\n  return (\n    <div className='p-4'>\n      <h1 className='text-3xl font-bold mb-4'>Welcome to Memerator!</h1>\n      <p className='mb-4'>Start generating meme ideas by providing topics and intended audience.</p>\n      <form onSubmit={handleGenerateMeme}>\n        <div className='mb-4 max-w-[500px]'>\n          <label htmlFor='topics' className='block font-bold mb-2'>\n            Topics:\n          </label>\n          {topics.map((topic, index) => (\n            <input\n              key={index}\n              type='text'\n              id='topics'\n              value={topic}\n              onChange={(e) => {\n                const updatedTopics = [...topics];\n                updatedTopics[index] = e.target.value;\n                setTopics(updatedTopics);\n              }}\n              className='p-1 mr-1 mb-1 border rounded text-lg focus:outline-none focus:ring-2 focus:ring-primary-600 focus:border-transparent'\n            />\n          ))}\n          <div className='flex items-center my-2 gap-1'>\n            <button\n              type='button'\n              onClick={() => topics.length < 3 && setTopics([...topics, ''])}\n              className='flex items-center gap-1 bg-primary-200 hover:bg-primary-300 border-2 text-black text-xs py-1 px-2 rounded'\n            >\n              <AiOutlinePlusCircle /> Add Topic\n            </button>\n            {topics.length > 1 && (\n              <button\n                onClick={() => setTopics(topics.slice(0, -1))}\n                className='flex items-center gap-1 bg-red-500 hover:bg-red-700 border-2 text-white text-xs py-1 px-2 rounded'\n              >\n                <AiOutlineMinusCircle /> Remove Topic\n              </button>\n            )}\n          </div>\n        </div>\n        <div className='mb-4'>\n          <label htmlFor='audience' className='block font-bold mb-2'>\n            Intended Audience:\n          </label>\n          <input\n            type='text'\n            id='audience'\n            value={audience}\n            onChange={(e) => setAudience(e.target.value)}\n            className='p-1 border rounded text-lg focus:outline-none focus:ring-2 focus:ring-primary-600 focus:border-transparent'\n          />\n        </div>\n        <button\n          type='submit'\n          className={`flex items-center gap-1 bg-primary-200 hover:bg-primary-300 border-2 text-black text-sm font-bold py-1 px-2 rounded ${\n            isMemeGenerating ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'\n          } $}`}\n        >\n          <AiOutlineRobot />\n          {!isMemeGenerating ? 'Generate Meme' : 'Generating...'}\n        </button>\n      </form>\n\n      {!!memes && memes.length > 0 ? (\n        memes.map((memeIdea) => (\n          <div key={memeIdea.id} className='mt-4 p-4 bg-gray-100 rounded-lg'>\n            <img src={memeIdea.url} width='500px' />\n            <div className='flex flex-col items-start mt-2'>\n              <div>\n                <span className='text-sm text-gray-700'>Topics: </span>\n                <span className='text-sm italic text-gray-500'>{memeIdea.topics}</span>\n              </div>\n              <div>\n                <span className='text-sm text-gray-700'>Audience: </span>\n                <span className='text-sm italic text-gray-500'>{memeIdea.audience}</span>\n              </div>\n            </div>\n            {/* TODO: implement edit and delete meme features */}\n          </div>\n        ))\n      ) : (\n        <div className='flex justify-center mt-5'> :( no memes found</div>\n      )}\n    </div>\n  );\n}\n")),(0,r.kt)("p",null,"There are two things I want to point out about this code:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"useQuery")," hook calls our ",(0,r.kt)("inlineCode",{parentName:"li"},"getAllMemes")," Query when the component mounts. It also caches the result for us, as well as automatically re-fetching whenever we add a new Meme to our DB via ",(0,r.kt)("inlineCode",{parentName:"li"},"createMeme"),". This means our page will reload automatically whenever a new meme is generated."),(0,r.kt)("li",{parentName:"ol"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"useAuth")," hook allows us to fetch info about our logged in user. If the user isn\u2019t logged in, we force them to do so before they can generate a meme.")),(0,r.kt)("p",null,"These are really cool Wasp features that make your life as a developer a lot easier \ud83d\ude42"),(0,r.kt)("p",null,"So go ahead now and try and generate a meme. Here\u2019s the one I just generated:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/c2ypm9n0uyra47mp5g85.png",alt:"Image description"})),(0,r.kt)("p",null,"Haha. Pretty good!"),(0,r.kt)("p",null,"Now wouldn\u2019t it be cool though if we could edit and delete our memes? And what if we could expand the set of meme templates for our generator to use? Wouldn\u2019t that be cool, too?"),(0,r.kt)("p",null,"Yes, it would be. So let\u2019s do that."),(0,r.kt)("a",{name:"part-two",href:"#part-two"}),(0,r.kt)("h1",{id:"part-2"},"Part 2."),(0,r.kt)("p",null,"So we\u2019ve got ourselves a really good basis for an app at this point."),(0,r.kt)("p",null,"We\u2019re using ",(0,r.kt)("a",{parentName:"p",href:"https://platform.openai.com/docs/guides/gpt/function-calling"},"OpenAI\u2019s function calling feature")," to explain a function to GPT, and get it to return results for us in a format we can use to call that function."),(0,r.kt)("p",null,"This allows us to be certain GPT\u2019s result will be usable in further parts of our application and opens up the door to creating AI agents."),(0,r.kt)("p",null,"If you think about it, we\u2019ve basically got ourselves a really simple Meme generating \u201cagent\u201d. How cool is that?!"),(0,r.kt)("a",{name:"templates",href:"#templates"}),(0,r.kt)("h2",{id:"fetching--updating-templates-with-cron-jobs"},"Fetching & Updating Templates with Cron Jobs"),(0,r.kt)("p",null,"To be able to generate our meme images via ",(0,r.kt)("a",{parentName:"p",href:"https://imgflip.com/api"},"ImgFlip\u2019s API"),", we have to choose and send a meme template ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," to the API, along with the text arguments we want to fill it in with."),(0,r.kt)("p",null,"For example, the ",(0,r.kt)("inlineCode",{parentName:"p"},"Grandma Finds Internet")," meme template has the following ",(0,r.kt)("inlineCode",{parentName:"p"},"id"),":"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/zoo4uainls9jxq7fzysv.png",alt:"Image description"})),(0,r.kt)("p",null,"But the only way for us to get available meme templates from ImgFlip is to send a ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," request to\n",(0,r.kt)("a",{parentName:"p",href:"https://api.imgflip.com/get_memes"},"https://api.imgflip.com/get_memes"),". And according to ImgFlip, the ",(0,r.kt)("strong",{parentName:"p"},"/get-memes")," endpoint works like this:"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Gets an array of popular memes that may be captioned with this API. The size of this array and the order of memes may change at any time. When this description was written, it returned 100 memes ordered by how many times they were captioned in the last 30 days")),(0,r.kt)("p",null,"So it returns a list of the top 100 memes from the last 30 days. And as this is always changing, we can run a daily cron job to fetch the list and update our database with any new templates that don\u2019t already exist in it."),(0,r.kt)("p",null,"We know this will work because the ImgFlip docs for the ",(0,r.kt)("strong",{parentName:"p"},"/caption-image")," endpoint \u2014 which we use to create a meme image \u2014 says this:"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("em",{parentName:"p"},"key:")," template_id\n",(0,r.kt)("em",{parentName:"p"},"value:")," A template ID as returned by the ",(0,r.kt)("strong",{parentName:"p"},"get_memes")," response. Any ID that was ever returned from the ",(0,r.kt)("strong",{parentName:"p"},"get_memes")," response should work for this parameter\u2026")),(0,r.kt)("p",null,"Awesome!"),(0,r.kt)("a",{name:"cron",href:"#cron"}),(0,r.kt)("h3",{id:"defining-our-daily-cron-job"},"Defining our Daily Cron Job"),(0,r.kt)("p",null,"Now, to create an automatically ",(0,r.kt)("a",{parentName:"p",href:"https://wasp-lang.dev/docs/advanced/jobs"},"recurring cron job in Wasp")," is really easy. "),(0,r.kt)("p",null,"First, go to your ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," file and add:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},'job storeMemeTemplates {\n  executor: PgBoss,\n  perform: {\n    fn: import { fetchAndStoreMemeTemplates } from "@server/workers.js",\n  },\n  schedule: {\n    // daily at 7 a.m.\n    cron: "0 7 * * *" \n  },\n  entities: [Template],\n}\n')),(0,r.kt)("p",null,"This is telling Wasp to run the ",(0,r.kt)("inlineCode",{parentName:"p"},"fetchAndStoreMemeTemplates")," function every day at 7 a.m."),(0,r.kt)("p",null,"Next, create a new file in ",(0,r.kt)("inlineCode",{parentName:"p"},"src/server")," called ",(0,r.kt)("inlineCode",{parentName:"p"},"workers.ts")," and add the function:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import axios from 'axios';\n\nexport const fetchAndStoreMemeTemplates = async (_args: any, context: any) => {\n  console.log('.... ><><>< get meme templates cron starting ><><>< ....');\n\n  try {\n    const response = await axios.get('https://api.imgflip.com/get_memes');\n\n    const promises = response.data.data.memes.map((meme: any) => {\n      return context.entities.Template.upsert({\n        where: { id: meme.id },\n        create: {\n          id: meme.id,\n          name: meme.name,\n          url: meme.url,\n          width: meme.width,\n          height: meme.height,\n          boxCount: meme.box_count,\n        },\n        update: {},\n      });\n    });\n\n    await Promise.all(promises);\n  } catch (error) {\n    console.error('error fetching meme templates: ', error);\n  }\n};\n")),(0,r.kt)("p",null,"You can see that we send a ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," request to the proper endpoint, then we loop through the array of memes it returns to us add any new templates to the database."),(0,r.kt)("p",null,"Notice that we use Prisma\u2019s ",(0,r.kt)("inlineCode",{parentName:"p"},"upsert")," method here. This allows us to create a new entity in the database if it doesn\u2019t already exist. If it does, we don\u2019t do anything, which is why ",(0,r.kt)("inlineCode",{parentName:"p"},"update")," is left blank."),(0,r.kt)("p",null,"We use ",(0,r.kt)("inlineCode",{parentName:"p"},"[Promise.all()")," to call that array of promises](",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all"},"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all"),") correctly."),(0,r.kt)("a",{name:"cron-test",href:"#cron-test"}),(0,r.kt)("h3",{id:"testing"},"Testing"),(0,r.kt)("p",null,"Now, assuming you\u2019ve got your app running with ",(0,r.kt)("inlineCode",{parentName:"p"},"wasp start"),", you will see the cron job run in the console every day at 7 a.m."),(0,r.kt)("p",null,"If you want to test that the cron job is working correctly, you could run it on a faster schedule. Let\u2019s try that now by changing it in our ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," file to run every minute:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},'//...\n  schedule: {\n    // runs every minute.\n    cron: "* * * * *" \n  },\n')),(0,r.kt)("p",null,"First, your terminal where you ran ",(0,r.kt)("inlineCode",{parentName:"p"},"wasp start")," to start your app should output the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'[Server]  \ud83d\udd0d Validating environment variables...\n[Server]  \ud83d\ude80 "Username and password" auth initialized\n[Server]  Starting pg-boss...\n[Server]  pg-boss started!\n[Server]  Server listening on port 3001\n')),(0,r.kt)("p",null,"\u2026followed shortly after by:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"[Server]  .... ><><>< get meme templates cron starting ><><>< ....\n")),(0,r.kt)("p",null,"Great. We\u2019ve got an automatically recurring cron job going."),(0,r.kt)("p",null,"You can check your database for saved templates by opening another terminal window and running:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"wasp db studio \n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/yldqge5186hegvzjyo30.png",alt:"Image description"})),(0,r.kt)("a",{name:"edit",href:"#edit"}),(0,r.kt)("h2",{id:"editing-memes"},"Editing Memes"),(0,r.kt)("p",null,"Unfortunately, sometimes GPT\u2019s results have some mistakes. Or sometimes the idea is really good, but we want to further modify it to make it even better."),(0,r.kt)("p",null,"Well, that\u2019s pretty simple for us to do since we can just make another call to ",(0,r.kt)("a",{parentName:"p",href:"https://imgflip.com/api"},"ImgFlip\u2019s API"),"."),(0,r.kt)("p",null,"So let\u2019s set do that by setting up a dedicated page where we:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"fetch that specific meme based on its ",(0,r.kt)("inlineCode",{parentName:"li"},"id")),(0,r.kt)("li",{parentName:"ul"},"display a form to allow the user to edit the meme ",(0,r.kt)("inlineCode",{parentName:"li"},"text")),(0,r.kt)("li",{parentName:"ul"},"send that info to a server-side Action which calls the ImgFlip API, generates a new image URL, and updates our ",(0,r.kt)("inlineCode",{parentName:"li"},"Meme")," entity in the DB.")),(0,r.kt)("a",{name:"server",href:"#server"}),(0,r.kt)("h3",{id:"server-side-code-1"},"Server-Side Code"),(0,r.kt)("p",null,"To make sure we can fetch the individual meme we want to edit, we first need to set up a Query that does this."),(0,r.kt)("p",null,"Go to your ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," file and add this Query declaration:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},'query getMeme {\n  fn: import { getMeme } from "@server/queries.js",\n  entities: [Meme]\n}\n')),(0,r.kt)("p",null,"Now go to ",(0,r.kt)("inlineCode",{parentName:"p"},"src/server/queries.ts")," and add the following function:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import type { Meme, Template } from '@wasp/entities';\nimport type { GetAllMemes, GetMeme } from '@wasp/queries/types';\n\ntype GetMemeArgs = { id: string };\ntype GetMemeResult = Meme & { template: Template };\n\n//...\n\nexport const getMeme: GetMeme<GetMemeArgs, GetMemeResult> = async ({ id }, context) => {\n  if (!context.user) {\n    throw new HttpError(401);\n  }\n\n  const meme = await context.entities.Meme.findUniqueOrThrow({\n    where: { id: id },\n    include: { template: true },\n  });\n\n  return meme;\n};\n")),(0,r.kt)("p",null,"We\u2019re just fetching the single meme based on its ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," from the database."),(0,r.kt)("p",null,"We\u2019re also including the related meme ",(0,r.kt)("inlineCode",{parentName:"p"},"Template")," so that we have access to its ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," as well, because we need to send this to the ImgFlip API too."),(0,r.kt)("p",null,"Pretty simple!"),(0,r.kt)("p",null,"Now let\u2019s create our ",(0,r.kt)("inlineCode",{parentName:"p"},"editMeme")," action by going to our ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," file and adding the following Action:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},'//...\n\naction editMeme {\n  fn: import { editMeme } from "@server/actions.js",\n  entities: [Meme, Template, User]\n}\n')),(0,r.kt)("p",null,"Next, move over to the ",(0,r.kt)("inlineCode",{parentName:"p"},"server/actions.ts")," file and let\u2019s add the following server-side function:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"//... other imports\nimport type { EditMeme } from '@wasp/actions/types';\n\n//... other types\ntype EditMemeArgs = Pick<Meme, 'id' | 'text0' | 'text1'>;\n\nexport const editMeme: EditMeme<EditMemeArgs, Meme> = async ({ id, text0, text1 }, context) => {\n  if (!context.user) {\n    throw new HttpError(401, 'You must be logged in');\n  }\n\n  const meme = await context.entities.Meme.findUniqueOrThrow({\n    where: { id: id },\n    include: { template: true },\n  });\n\n  if (!context.user.isAdmin && meme.userId !== context.user.id) {\n    throw new HttpError(403, 'You are not the creator of this meme');\n  }\n\n  const memeUrl = await generateMemeImage({\n    templateId: meme.template.id,\n    text0: text0,\n    text1: text1,\n  });\n\n  const newMeme = await context.entities.Meme.update({\n    where: { id: id },\n    data: {\n      text0: text0,\n      text1: text1,\n      url: memeUrl,\n    },\n  });\n\n  return newMeme;\n};\n")),(0,r.kt)("p",null,"As you can see, this function expects the ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," of the already existing meme, along with the new ",(0,r.kt)("inlineCode",{parentName:"p"},"text")," boxes. That\u2019s because we\u2019re letting the user manually input/edit the text that GPT generated, rather than making another request the the OpenAI API."),(0,r.kt)("p",null,"Next, we look for that specific meme in our database, and if we don\u2019t find it we throw an error (",(0,r.kt)("inlineCode",{parentName:"p"},"findUniqueOrThrow"),")."),(0,r.kt)("p",null,"We check to make sure that that meme belongs to the user that is currently making the request, because we don\u2019t want a different user to edit a meme that doesn\u2019t belong to them."),(0,r.kt)("p",null,"Then we send the template ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," of that meme along with the new text to our previously created ",(0,r.kt)("inlineCode",{parentName:"p"},"generateMemeImage")," function. This function calls the ImgFlip API and returns the url of the newly created meme image."),(0,r.kt)("p",null,"We then ",(0,r.kt)("inlineCode",{parentName:"p"},"update")," the database to save the new URL to our Meme."),(0,r.kt)("p",null,"Awesome!"),(0,r.kt)("a",{name:"client",href:"#client"}),(0,r.kt)("h3",{id:"client-side-code-1"},"Client-Side Code"),(0,r.kt)("p",null,"Let\u2019s start by adding a new route and page to our ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},'//...\n\nroute EditMemeRoute { path: "/meme/:id", to: EditMemePage }\npage EditMemePage {\n  component: import { EditMemePage } from "@client/pages/EditMemePage",\n  authRequired: true\n}\n')),(0,r.kt)("p",null,"There are two important things to notice:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"the path includes the ",(0,r.kt)("inlineCode",{parentName:"li"},":id")," parameter, which means we can access page for any meme in our database by going to, e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},"memerator.com/meme/5")),(0,r.kt)("li",{parentName:"ol"},"by using the ",(0,r.kt)("inlineCode",{parentName:"li"},"authRequired")," option, we tell Wasp to automatically block this page from unauthorized users. Nice!")),(0,r.kt)("p",null,"Now, create this page by adding a new file called ",(0,r.kt)("inlineCode",{parentName:"p"},"EditMemePage.tsx")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"src/client/pages"),". Add the following code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import { useState, useEffect, FormEventHandler } from 'react';\nimport { useQuery } from '@wasp/queries';\nimport editMeme from '@wasp/actions/editMeme';\nimport getMeme from '@wasp/queries/getMeme';\nimport { useParams } from 'react-router-dom';\nimport { AiOutlineEdit } from 'react-icons/ai';\n\nexport function EditMemePage() {\n  // http://localhost:3000/meme/573f283c-24e2-4c45-b6b9-543d0b7cc0c7\n  const { id } = useParams<{ id: string }>();\n\n  const [text0, setText0] = useState('');\n  const [text1, setText1] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n\n  const { data: meme, isLoading: isMemeLoading, error: memeError } = useQuery(getMeme, { id: id });\n\n  useEffect(() => {\n    if (meme) {\n      setText0(meme.text0);\n      setText1(meme.text1);\n    }\n  }, [meme]);\n\n  const handleSubmit: FormEventHandler<HTMLFormElement> = async (e) => {\n    e.preventDefault();\n    try {\n      setIsLoading(true);\n      await editMeme({ id, text0, text1 });\n    } catch (error: any) {\n      alert('Error generating meme: ' + error.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (isMemeLoading) return 'Loading...';\n  if (memeError) return 'Error: ' + memeError.message;\n\n  return (\n    <div className='p-4'>\n      <h1 className='text-3xl font-bold mb-4'>Edit Meme</h1>\n      <form onSubmit={handleSubmit}>\n        <div className='flex gap-2 items-end'>\n          <div className='mb-2'>\n            <label htmlFor='text0' className='block font-bold mb-2'>\n              Text 0:\n            </label>\n            <textarea\n              id='text0'\n              value={text0}\n              onChange={(e) => setText0(e.target.value)}\n              className='border rounded px-2 py-1'\n            />\n          </div>\n          <div className='mb-2'>\n            <label htmlFor='text1' className='block font-bold mb-2'>\n              Text 1:\n            </label>\n\n            <div className='flex items-center mb-2'>\n              <textarea\n                id='text1'\n                value={text1}\n                onChange={(e) => setText1(e.target.value)}\n                className='border rounded px-2 py-1'\n              />\n            </div>\n          </div>\n        </div>\n\n        <button\n          type='submit'\n          className={`flex items-center gap-1 bg-primary-200 hover:bg-primary-300 border-2 text-black text-sm py-1 px-2 rounded ${\n            isLoading ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'\n          } $}`}\n        >\n          <AiOutlineEdit />\n          {!isLoading ? 'Save Meme' : 'Saving...'}\n        </button>\n      </form>\n      {!!meme && (\n        <div className='mt-4  mb-2 bg-gray-100 rounded-lg p-4'>\n          <img src={meme.url} width='500px' />\n          <div className='flex flex-col items-start mt-2'>\n            <div>\n              <span className='text-sm text-gray-700'>Topics: </span>\n              <span className='text-sm italic text-gray-500'>{meme.topics}</span>\n            </div>\n            <div>\n              <span className='text-sm text-gray-700'>Audience: </span>\n              <span className='text-sm italic text-gray-500'>{meme.audience}</span>\n            </div>\n            <div>\n              <span className='text-sm text-gray-700'>ImgFlip Template: </span>\n              <span className='text-sm italic text-gray-500'>{meme.template.name}</span>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n")),(0,r.kt)("p",null,"Some things to notice here are:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"because we\u2019re using dynamic routes (",(0,r.kt)("inlineCode",{parentName:"li"},"/meme/:id"),"), we pull the URL paramater ",(0,r.kt)("inlineCode",{parentName:"li"},"id")," from the url with ",(0,r.kt)("inlineCode",{parentName:"li"},"useParams")," hook."),(0,r.kt)("li",{parentName:"ol"},"we then pass that ",(0,r.kt)("inlineCode",{parentName:"li"},"id")," within the ",(0,r.kt)("inlineCode",{parentName:"li"},"getMemes")," Query to fetch that specific meme to edit: ",(0,r.kt)("inlineCode",{parentName:"li"},"useQuery(getMeme, { id: id })"),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"remember, our server-side action depends on this ",(0,r.kt)("inlineCode",{parentName:"li"},"id")," in order to fetch the meme from our database")))),(0,r.kt)("p",null,"The rest of the page is just our form for calling the ",(0,r.kt)("inlineCode",{parentName:"p"},"editMeme")," Action, as well as displaying the meme we want to edit."),(0,r.kt)("p",null,"That\u2019s great!"),(0,r.kt)("p",null,"Now that we have that ",(0,r.kt)("inlineCode",{parentName:"p"},"EditMemePage"),", we need a way to navigate to it from the home page."),(0,r.kt)("p",null,"To do that, go back to the ",(0,r.kt)("inlineCode",{parentName:"p"},"Home.tsx")," file, add the following imports at the top, and find the comment that says ",(0,r.kt)("inlineCode",{parentName:"p"},"{/* TODO: implement edit and delete meme features */}")," and replace it with the following code: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import { Link } from '@wasp/router';\nimport { AiOutlineEdit } from 'react-icons/ai';\n\n//...\n\n{user && (user.isAdmin || user.id === memeIdea.userId) && (\n  <div className='flex items-center mt-2'>\n    <Link key={memeIdea.id} params={{ id: memeIdea.id }} to={`/meme/:id`}>\n      <button className='flex items-center gap-1 bg-primary-200 hover:bg-primary-300 border-2 text-black text-xs py-1 px-2 rounded'>\n        <AiOutlineEdit />\n        Edit Meme\n      </button>\n    </Link>\n    {/* TODO: add delete meme functionality */}\n  </div>\n)}\n")),(0,r.kt)("p",null,"What\u2019s really cool about this, is that Wasp\u2019s ",(0,r.kt)("inlineCode",{parentName:"p"},"Link")," component will give you ",(0,r.kt)("a",{parentName:"p",href:"https://wasp-lang.dev/docs/advanced/links"},"type-safe routes"),", by making sure you\u2019re following the pattern you defined in your ",(0,r.kt)("inlineCode",{parentName:"p"},"main.wasp")," file."),(0,r.kt)("p",null,"And with that, so long as the authenticated user was the creator of the meme (or is an admin), the ",(0,r.kt)("inlineCode",{parentName:"p"},"Edit Meme")," button will show up and direct the user to the ",(0,r.kt)("inlineCode",{parentName:"p"},"EditMemePage")),(0,r.kt)("p",null,"Give it a try now. It should look like this:"),(0,r.kt)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/ymSr2eRXz9c?si=BI9s2WEHnRiPtC3G",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:!0}),(0,r.kt)("a",{name:"delete",href:"#delete"}),(0,r.kt)("h2",{id:"deleting-memes"},"Deleting Memes"),(0,r.kt)("p",null,"Ok. When I initially started writing this tutorial, I thought I\u2019d also explain how to add ",(0,r.kt)("inlineCode",{parentName:"p"},"delete")," meme functionality to the app as well."),(0,r.kt)("p",null,"But seeing as we\u2019ve gotten this far, and as the entire two-part tutorial is pretty long, I figured you should be able to implement yourself by this point."),(0,r.kt)("p",null,"So I\u2019ll leave you guide as to how to implement it yourself. Think of it as a bit of homework:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"define the ",(0,r.kt)("inlineCode",{parentName:"li"},"deleteMeme")," Action in your ",(0,r.kt)("inlineCode",{parentName:"li"},"main.wasp")," file"),(0,r.kt)("li",{parentName:"ol"},"export the async function from the ",(0,r.kt)("inlineCode",{parentName:"li"},"actions.ts")," file"),(0,r.kt)("li",{parentName:"ol"},"import the Action in your client-side code"),(0,r.kt)("li",{parentName:"ol"},"create a button which takes the meme\u2019s ",(0,r.kt)("inlineCode",{parentName:"li"},"id")," as an argument in your ",(0,r.kt)("inlineCode",{parentName:"li"},"deleteMeme")," Action.")),(0,r.kt)("p",null,"If you get stuck, you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"editMeme")," section as a guide. Or you can check out the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/vincanger/memerator/"},"finished app\u2019s GitHub repo")," for the completed code!"),(0,r.kt)("a",{name:"conclusion",href:"#conclusion"}),(0,r.kt)("h1",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"There you have it! Your own instant meme generator \ud83e\udd16\ud83d\ude06"),(0,r.kt)("p",null,"BTW, If you found this useful,\xa0",(0,r.kt)("strong",{parentName:"p"},"please show us your support by\xa0",(0,r.kt)("a",{parentName:"strong",href:"https://github.com/wasp-lang/wasp"},"giving us a star on GitHub")),"! It will help us continue to make more stuff just like it. "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://res.cloudinary.com/practicaldev/image/fetch/s--tnDxibZC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_800/https://res.cloudinary.com/practicaldev/image/fetch/s--OCpry2p9--/c_limit%252Cf_auto%252Cfl_progressive%252Cq_66%252Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/bky8z46ii7ayejprrqw3.gif",alt:"https://res.cloudinary.com/practicaldev/image/fetch/s--tnDxibZC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_800/https://res.cloudinary.com/practicaldev/image/fetch/s--OCpry2p9--/c_limit%252Cf_auto%252Cfl_progressive%252Cq_66%252Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/bky8z46ii7ayejprrqw3.gif"})))}d.isMDXComponent=!0}}]);